<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë¡œê·¸ì¸ | ì¼ë ‰íŠ¸ë¦¬</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="login-container">
    <h2>ë¡œê·¸ì¸</h2>

    <form onsubmit="login(event)">

      <!-- ID ì…ë ¥ -->
      <div class="input-box">
        <input type="text" id="userId" placeholder="ê°•ì‚¬ ID" required />
      </div>

      <!-- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ -->
      <div class="password-box">
        <input
          type="password"
          id="password"
          placeholder="ë¹„ë°€ë²ˆí˜¸"
          required
          inputmode="latin"
          autocomplete="new-password"
          autocorrect="off"
          spellcheck="false"
        />
        <span id="togglePassword" class="toggle-eye">ğŸ™ˆ</span>
      </div>

      <!-- ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€ + IP ë³´ì•ˆ -->
      <div class="remember-security-row">
        <label class="remember-left">
          <input type="checkbox" id="autoLogin">
          ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€
        </label>

        <label class="security-right">
          IP ë³´ì•ˆ
          <label class="switch">
            <input type="checkbox" id="ipSecurity">
            <span class="slider"></span>
          </label>
        </label>
      </div>

      <!-- ë¡œê·¸ì¸ ë²„íŠ¼ -->
      <button type="submit" class="login-btn">ë¡œê·¸ì¸</button>
    </form>
  </div>

  <!-- â­ ìë™ ë¡œê·¸ì¸ ì²´í¬ -->
  <script>
    const USERS = [
      { id: "admin", password: "Aveeno10!", role: "admin" },
      { id: "ê°•ì‚¬A", password: "passA", role: "instructor" },
      { id: "ê°•ì‚¬B", password: "passB", role: "instructor" }
    ];

    // âœ” ìë™ ë¡œê·¸ì¸(localStorageë§Œ í™•ì¸)
    window.onload = function () {
      const savedUser = localStorage.getItem("loggedInUser");

      if (savedUser) {
        const user = JSON.parse(savedUser);

        if (user.role === "admin") {
          window.location.href = "admin.html";
        } else {
          window.location.href = "menu.html";
        }
      }
    };

    // âœ” ë¡œê·¸ì¸ í•¨ìˆ˜
    function login(event) {
      event.preventDefault();

      const id = document.getElementById("userId").value.trim();
      const pw = document.getElementById("password").value.trim();
      const auto = document.getElementById("autoLogin").checked;

      const user = USERS.find(u => u.id === id && u.password === pw);

      if (!user) {
        alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
        return;
      }

      // âœ” í•­ìƒ sessionStorage ì €ì¥
      sessionStorage.setItem("loggedInUser", JSON.stringify(user));

      // âœ” ìë™ ë¡œê·¸ì¸ ì²´í¬í•˜ë©´ localStorageë„ ì €ì¥
      if (auto) {
        localStorage.setItem("loggedInUser", JSON.stringify(user));
      }

      // âœ” í˜ì´ì§€ ì´ë™
      if (user.role === "admin") {
        window.location.href = "admin.html";
      } else {
        window.location.href = `menu.html?instructor=${encodeURIComponent(user.id)}`;
      }
    }
  </script>

  <!-- â­ ë¹„ë°€ë²ˆí˜¸ ë³´ê¸° í† ê¸€ -->
  <script>
    const pwInput = document.getElementById("password");
    const toggleBtn = document.getElementById("togglePassword");

    toggleBtn.addEventListener("click", () => {
      const isVisible = pwInput.type === "text";
      pwInput.type = isVisible ? "password" : "text";
      toggleBtn.textContent = isVisible ? "ğŸ™ˆ" : "ğŸ‘€";
    });
  </script>

</body>
</html>
